<?xml version="1.0" encoding="UTF-8"?>
<plugin>

   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="false"
            locationURI="popup:org.bonitasoft.studio.application.project.explorer?after=team.main">
         <command
               commandId="org.bonitasoft.studio.team.git.command.share"
               icon="icons/git.png"
               style="push">
            <visibleWhen
                  checkEnabled="false">
	               <with
	                     variable="activeMenuSelection">
	                  <and>
		                  <count
		                        value="1">
		                  </count>
	                     <iterate>
	                        <instanceof
	                              value="org.eclipse.core.resources.IProject">
	                        </instanceof>
	                        <test
	                              property="org.bonitasoft.studio.application.isBonitaProject">
	                        </test>
	                        <test
	                              property="org.bonitasoft.studio.team.git.isProjectNotShared">
	                        </test>
	                     </iterate>
		               </and>
	               </with>
	            </visibleWhen>
         </command>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.core.expressions.propertyTesters">
      <propertyTester
            properties="isProjectNotShared"
            namespace="org.bonitasoft.studio.team.git"
            type="org.eclipse.core.resources.IProject"
            class="org.bonitasoft.studio.team.git.ProjectNotSharedPropertyTester"
            id="org.bonitasoft.studio.team.git.projectNotSharedPropertyTester">
      </propertyTester>
   </extension>
   <extension
         id="org.bonitasoft.studio.team.git.fragment"
         point="org.eclipse.e4.workbench.model">
      <fragment
            uri="fragment.e4xmi">
      </fragment>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="org.bonitasoft.studio.team.git.core.ShareGitProject"
            commandId="org.bonitasoft.studio.team.git.command.share">
      </handler>
      <handler
            class="org.bonitasoft.studio.team.git.core.CloneGitProject"
            commandId="org.bonitasoft.studio.team.git.command.clone">
      </handler>
   </extension>
   <extension
         point="org.eclipse.core.runtime.preferences">
      <initializer
            class="org.bonitasoft.studio.team.git.PreferenceInitializer">
      </initializer>
   </extension>
   <extension
         point="org.eclipse.ui.commandImages">
      <image
            commandId="org.bonitasoft.studio.team.git.command.clone"
            icon="icons/cloneGit.png">
      </image>
      <image
            commandId="org.bonitasoft.studio.team.git.command.share"
            icon="icons/git.png">
      </image>
  icons/cloneGit.png </extension>
   <extension point="org.bonitasoft.studio.common.ui.coolbarContributionItem">
      <coolbarItem
            class="org.bonitasoft.studio.team.git.ui.GitCoolbarItem"
            priority="0"
            toolbarPosition="4">
      </coolbarItem>
   </extension>
   <extension
         point="org.eclipse.core.runtime.adapters">
      <factory
            adaptableType="org.bonitasoft.studio.team.repository.Repository"
            class="org.bonitasoft.studio.team.git.validation.RepositoryValidationAdapterFactory">
         <adapter
               type="org.bonitasoft.studio.team.git.validation.RepositoryValidator">
         </adapter>
         <adapter
               type="org.bonitasoft.studio.common.core.IRunnableWithStatus">
         </adapter>
      </factory>
   </extension>
   <extension 
   		id="validation.committedIgnoredMarker"
    	point="org.eclipse.core.resources.markers"
    	name="Repository validation">
        <super type="org.eclipse.core.resources.problemmarker"/>
        <persistent value="true"/>
    </extension>
   <extension 
   		id="validation.ignoreNotAlignedMarker"
    	point="org.eclipse.core.resources.markers"
    	name="Repository validation">
        <super type="org.eclipse.core.resources.problemmarker"/>
        <persistent value="true"/>
    </extension>
   <extension
         point="org.eclipse.ui.ide.markerResolution">
      <markerResolutionGenerator
            markerType="org.bonitasoft.studio.team.git.validation.committedIgnoredMarker"
            class="org.bonitasoft.studio.team.git.ui.CommittedIgnoredResolutionGenerator">
      </markerResolutionGenerator>
      <markerResolutionGenerator
            markerType="org.bonitasoft.studio.team.git.validation.ignoreNotAlignedMarker"
            class="org.bonitasoft.studio.team.git.ui.IgnoredNotAlignedResolutionGenerator">
      </markerResolutionGenerator>
   </extension>

</plugin>
