<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension-point id="org.bonitasoft.studio.engine.kpityperesolver" name="org.bonitasoft.studio.engine.kpityperesolver" schema="schema/org.bonitasoft.studio.engine.kpityperesolver.exsd"/>
   <extension-point id="preEngineAction" name="preEngineAction" schema="schema/preEngineAction.exsd"/>
   <extension-point id="postEngineAction" name="preEngineAction" schema="schema/postEngineAction.exsd"/>
   <extension-point id="bonitaWebServerManager" name="bonitaWebServerManager" schema="schema/bonitaWebServerManager.exsd"/>
   <extension-point id="org.bonitasoft.studio.engine.processDefinitionExporter" name="org.bonitasoft.studio.engine.processDefinitionExporter" schema="schema/org.bonitasoft.studio.engine.processDefinitionExporter.exsd"/>
   <extension-point id="bonitaEngineManager" name="bonitaEngineManager" schema="schema/bonitaEngineManager.exsd"/>
   <extension-point id="org.bonitasoft.studio.engine.definition.builder" name="org.bonitasoft.studio.engine.definition.builder" schema="schema/DefinitionBuilder.exsd"/>
  <extension
        point="org.eclipse.ui.commands">
        <command
            id="org.bonitasoft.studio.engine.runCommand"
            name="%runProcessCommand">
           <commandParameter
                 id="configuration"
                 name="configuration"
                 optional="true">
           </commandParameter>
      </command>
      <command
            defaultHandler="org.bonitasoft.studio.engine.command.RestartServerCommand"
            id="org.bonitasoft.studio.engine.resetServerCommand"
            name="%resetServerCommand">
      </command>
       <command
            id="org.bonitasoft.studio.engine.exportAsBarCommand"
            name="%buildBarLabel">
      </command>
       <commandParameterType
             id="org.bonitasoft.studio.commandParameterType.abstractProcess"
             type="org.bonitasoft.studio.model.process.AbstractProcess">
       </commandParameterType>
  </extension>
  <extension
        point="org.bonitasoft.studio.coolbarContributionItem">
     <coolbarItem
           class="org.bonitasoft.studio.engine.coolbar.RunCoolbarItem"
           priority="0"
           toolbarPosition="12">
     </coolbarItem>
     <coolbarItem
           class="org.bonitasoft.studio.engine.coolbar.OpenPortalCoolbarItem"
           priority="0"
           toolbarPosition="13">
     </coolbarItem>
  </extension>
     <extension
         point="org.eclipse.ui.preferencePages">
         <page
            class="org.bonitasoft.studio.engine.preferences.ServerPreferencePage"
            id="org.bonitasoft.studio.preferences.server"
            name="Server preference page">
         <keywordReference
               id="org.bonitasoft.studio.preferences.keywordReference.server">
         </keywordReference>       
      </page>
   </extension>
  <extension
        point="org.eclipse.core.runtime.preferences">

     <initializer
           class="org.bonitasoft.studio.engine.preferences.EnginePreferencesInitializer">
     </initializer>
  </extension>
  <extension
        point="org.eclipse.ui.menus">
     <menuContribution
           allPopups="false"
           locationURI="menu:org.eclipse.ui.main.menu?after=org.bonitasoft.studio.development">
        <menu
              id="org.bonitasoft.studio.menu.run"
              label="%serverMenuLabel">
           <command
                 commandId="org.bonitasoft.studio.engine.runCommand"
                 icon="icons/run.png"
                 style="push">
           </command>
           <command
                 commandId="org.bonitasoft.studio.application.openConsole"
                 disabledIcon="icons/user_xp_disabled.png"
                 icon="icons/user_xp.png"
                 style="push">
           </command>
           <separator
                 name="org.bonitasoft.studio.engine.separator1"
                 visible="true">
           </separator>
           <command
                 commandId="org.bonitasoft.studio.engine.exportAsBarCommand"
                 disabledIcon="icons/export_disabled.png"
                 icon="icons/export.png"
                 style="push">
           </command>
           <separator
                 name="org.bonitasoft.studio.engine.separator2"
                 visible="true">
           </separator>
           <command
                 commandId="org.bonitasoft.studio.engine.resetServerCommand"
                 icon="icons/reset_server.png"
                 style="push">
           </command>
           <visibleWhen
                 checkEnabled="true">
              <reference
                    definitionId="isBonitaPerspectiveActive">
              </reference>
           </visibleWhen>
        </menu>
     </menuContribution>
     <menuContribution
           allPopups="false"
           locationURI="popup:org.bonitasoft.studio.application.project.explorer?after=group.build">
        <menu
              icon="icons/export.png"
              id="org.bonitasoft.studio.engine.buildDiagram"
              label="%build">
           <dynamic
                 class="org.bonitasoft.studio.engine.ui.contributionItem.BuildProcessContributionItem"
                 id="org.bonitasoft.studio.engine.buildContributionItem">
           </dynamic>
           <visibleWhen
                  checkEnabled="false">
               <with
                     variable="activeMenuSelection">
                  <and>
	                 <count
	                       value="1">
	                 </count>
	                 <iterate>
	                    <test
	                          property="org.bonitasoft.studio.diagram.isDiagramFile">
	                    </test>
	                 </iterate>
	              </and>
               </with>
            </visibleWhen>
        </menu>
     </menuContribution>
  </extension>
  <extension
        point="org.eclipse.ui.handlers">
     <handler
           class="org.bonitasoft.studio.engine.command.ExportAsBarFileHandler"
           commandId="org.bonitasoft.studio.engine.exportAsBarCommand">
     </handler>
     <handler
           class="org.bonitasoft.studio.engine.command.RunProcessCommand"
           commandId="org.bonitasoft.studio.engine.runCommand">
     </handler>
  </extension>
  <extension
         id="org.bonitasoft.studio.engine.fragment"
         point="org.eclipse.e4.workbench.model">
      <fragment
            uri="fragment.e4xmi">
      </fragment>
   </extension>
  <extension
        point="org.bonitasoft.studio.common.repository.projectListenerProvider">
     <projectListenerProvider
           class="org.bonitasoft.studio.engine.contribution.BonitaProjectListenerProvider">
     </projectListenerProvider>
  </extension>
  <extension
        point="org.eclipse.ui.keywords">
     <keyword
           id="org.bonitasoft.studio.preferences.keywordReference.server"
           label="%serverKeywords">
     </keyword>
  </extension>
  <extension
        point="org.bonitasoft.studio.common.barResourcesProvider">
     <barResourceProvider
           providerClass="org.bonitasoft.studio.engine.contribution.AdditionalResourcesBARResourcesProvider">
     </barResourceProvider>
  </extension>
</plugin>
