<?xml version="1.0" encoding="UTF-8"?>
<setup:Project
    xmi:version="2.0"
    xmlns:xmi="http://www.omg.org/XMI"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:git="http://www.eclipse.org/oomph/setup/git/1.0"
    xmlns:maven="http://www.eclipse.org/oomph/setup/maven/1.0"
    xmlns:pde="http://www.eclipse.org/oomph/setup/pde/1.0"
    xmlns:predicates="http://www.eclipse.org/oomph/predicates/1.0"
    xmlns:projects="http://www.eclipse.org/oomph/setup/projects/1.0"
    xmlns:setup="http://www.eclipse.org/oomph/setup/1.0"
    xmlns:setup.targlets="http://www.eclipse.org/oomph/setup/targlets/1.0"
    xmlns:setup.workingsets="http://www.eclipse.org/oomph/setup/workingsets/1.0"
    xsi:schemaLocation="http://www.eclipse.org/oomph/setup/git/1.0 http://git.eclipse.org/c/oomph/org.eclipse.oomph.git/plain/setups/models/Git.ecore http://www.eclipse.org/oomph/setup/maven/1.0 http://git.eclipse.org/c/oomph/org.eclipse.oomph.git/plain/setups/models/Maven.ecore http://www.eclipse.org/oomph/setup/pde/1.0 http://git.eclipse.org/c/oomph/org.eclipse.oomph.git/plain/setups/models/PDE.ecore http://www.eclipse.org/oomph/predicates/1.0 http://git.eclipse.org/c/oomph/org.eclipse.oomph.git/plain/setups/models/Predicates.ecore http://www.eclipse.org/oomph/setup/projects/1.0 http://git.eclipse.org/c/oomph/org.eclipse.oomph.git/plain/setups/models/Projects.ecore http://www.eclipse.org/oomph/setup/targlets/1.0 http://git.eclipse.org/c/oomph/org.eclipse.oomph.git/plain/setups/models/SetupTarglets.ecore http://www.eclipse.org/oomph/setup/workingsets/1.0 http://git.eclipse.org/c/oomph/org.eclipse.oomph.git/plain/setups/models/SetupWorkingSets.ecore"
    name="bonita-studio-sp"
    label="BonitaStudio Subscription &amp; Community">
  <setupTask
      xsi:type="setup:CompoundTask"
      href="BonitaStudio-common.setup#BonitaStudio-common"/>
  <setupTask
      xsi:type="setup:VariableTask"
      name="email"
      defaultValue="${firstname|lower}.${lastname|lower}@bonitasoft.com"
      label="Email"/>
  <setupTask
      xsi:type="setup:VariableTask"
      id="licenseDisclaimer"
      name="licenseDisclaimer"
      storageURI="scope://Workspace"
      label="License disclaimer to use">
    <choice
        value=" * BonitaSoft, 32 rue Gustave Eiffel - 38000 Grenoble&#xD;&#xA; * This program is free software: you can redistribute it and/or modify&#xD;&#xA; * it under the terms of the GNU General Public License as published by&#xD;&#xA; * the Free Software Foundation, either version 2.0 of the License, or&#xD;&#xA; * (at your option) any later version.&#xD;&#xA; * This program is distributed in the hope that it will be useful,&#xD;&#xA; * but WITHOUT ANY WARRANTY; without even the implied warranty of&#xD;&#xA; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the&#xD;&#xA; * GNU General Public License for more details.&#xD;&#xA; * You should have received a copy of the GNU General Public License&#xD;&#xA; * along with this program. If not, see &amp;lt;http://www.gnu.org/licenses/&amp;gt;."
        label="Community License"/>
    <choice
        value=" * BonitaSoft is a trademark of BonitaSoft SA.&#xA; * This software file is BONITASOFT CONFIDENTIAL. Not For Distribution.&#xA; * For commercial licensing information, contact:&#xA; *      BonitaSoft, 32 rue Gustave Eiffel â€“ 38000 Grenoble&#xA; *      or BonitaSoft US, 51 Federal Street, Suite 305, San Francisco, CA 94107"
        label="Subscription License"/>
  </setupTask>
  <setupTask
      xsi:type="setup:VariableTask"
      id="mavenSettingsStudio"
      type="FILE"
      name="mavenSettingsStudio"
      defaultValue="${user.home/.m2/settings.xml}"
      label="Maven settings.xml file (will be erased)">
    <description>The settings.xml file, usually located in maven .m2 folder, which will be used to build Studio</description>
  </setupTask>
  <setupTask
      xsi:type="setup:CompoundTask"
      name="org.eclipse.m2e.core">
    <setupTask
        xsi:type="setup:VariableTask"
        name="JFrogApiKey"
        label="JFrog API Key">
      <description>Your JFrog API Key (encrypted if you follow the encryption steps)  with maven. ( See https://bonitasoft.atlassian.net/wiki/spaces/BS/pages/13915193514/JFrog+Artifactory+Guide+for+a+Bonita+Engineering )</description>
    </setupTask>
    <setupTask
        xsi:type="setup:ResourceCreationTask"
        force="true"
        targetURL="${mavenSettingsStudio|uri}"
        encoding="UTF-8">
      <description>Create the settings.xml file in .m2 directory</description>
      <content>
        &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>
        &lt;settings
                xsi:schemaLocation=&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;
                xmlns=&quot;http://maven.apache.org/SETTINGS/1.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;>
            &lt;profiles>
                &lt;profile>
                    &lt;id>bonitasoft-rd&lt;/id>
                    &lt;repositories>
                        &lt;repository>
                            &lt;snapshots>
                                &lt;enabled>false&lt;/enabled>
                            &lt;/snapshots>
                            &lt;id>releases&lt;/id>
                            &lt;name>releases&lt;/name>
                            &lt;url>https://bonitasoft.jfrog.io/artifactory/releases&lt;/url>
                        &lt;/repository>
                        &lt;repository>
                            &lt;releases>
        				        &lt;enabled>false&lt;/enabled>
        					&lt;/releases>
        					&lt;snapshots>
        						&lt;enabled>true&lt;/enabled>
        					&lt;/snapshots>
                            &lt;id>snapshots&lt;/id>
                            &lt;name>snapshots&lt;/name>
                            &lt;url>https://bonitasoft.jfrog.io/artifactory/snapshots&lt;/url>
                        &lt;/repository>
                    &lt;/repositories>
                    &lt;pluginRepositories>
                        &lt;pluginRepository>
                            &lt;snapshots>
                                &lt;enabled>false&lt;/enabled>
                            &lt;/snapshots>
                            &lt;id>releases&lt;/id>
                            &lt;name>releases&lt;/name>
                            &lt;url>https://bonitasoft.jfrog.io/artifactory/releases&lt;/url>
                        &lt;/pluginRepository>
                        &lt;pluginRepository>
                            &lt;releases>
        				        &lt;enabled>false&lt;/enabled>
        					&lt;/releases>
        					&lt;snapshots>
        						&lt;enabled>true&lt;/enabled>
        					&lt;/snapshots>
                            &lt;id>snapshots&lt;/id>
                            &lt;name>snapshots&lt;/name>
                            &lt;url>https://bonitasoft.jfrog.io/artifactory/snapshots&lt;/url>
                        &lt;/pluginRepository>
                    &lt;/pluginRepositories>
                &lt;/profile>
            &lt;/profiles>
            &lt;activeProfiles>
                &lt;activeProfile>bonitasoft-rd&lt;/activeProfile>
            &lt;/activeProfiles>
            &lt;servers>
                &lt;server>
                    &lt;username>${email}&lt;/username>
                    &lt;password>${JFrogApiKey}&lt;/password>
                    &lt;id>snapshots&lt;/id>
                &lt;/server>
                &lt;server>
                    &lt;username>${email}&lt;/username>
                    &lt;password>${JFrogApiKey}&lt;/password>
                    &lt;id>releases&lt;/id>
                &lt;/server>
                &lt;server>
                    &lt;username>${email}&lt;/username>
                    &lt;password>${JFrogApiKey}&lt;/password>
                    &lt;!-- to allow Maven Fabric8 plugin retrieve Docker pull credentials -->
                    &lt;id>bonitasoft.jfrog.io&lt;/id>
                &lt;/server>
            &lt;/servers>
        &lt;/settings>
      </content>
    </setupTask>
  </setupTask>
  <setupTask
      xsi:type="git:GitCloneTask"
      id="git.clone.bonita-studio-sp"
      remoteURI="bonitasoft/bonita-studio-sp">
    <annotation
        source="http://www.eclipse.org/oomph/setup/InducedChoices">
      <detail
          key="inherit">
        <value>github.remoteURIs</value>
      </detail>
      <detail
          key="label">
        <value>${scope.project.label} Github repository</value>
      </detail>
      <detail
          key="target">
        <value>remoteURI</value>
      </detail>
    </annotation>
    <description>${scope.project.label}</description>
  </setupTask>
  <setupTask
      xsi:type="maven:MavenImportTask">
    <sourceLocator
        rootFolder="${git.clone.bonita-studio-sp.location}"/>
  </setupTask>
  <setupTask
      xsi:type="projects:ProjectsImportTask"
      force="true">
    <sourceLocator
        rootFolder="${git.clone.bonita-studio-sp.location}"
        locateNestedProjects="true"/>
  </setupTask>
  <setupTask
      xsi:type="setup.workingsets:WorkingSetTask"
      predecessor="//@setupTasks.7">
    <workingSet
        name="community-patched-plugin">
      <predicate
          xsi:type="predicates:LocationPredicate"
          pattern="\Q${git.clone.bonita-studio-sp.location|path}\E/community/patched-plugins/.*"/>
    </workingSet>
    <workingSet
        name="community-feature">
      <predicate
          xsi:type="predicates:LocationPredicate"
          pattern="\Q${git.clone.bonita-studio-sp.location|path}\E/community/bundles/features/.*"/>
    </workingSet>
    <workingSet
        name="community-plugin">
      <predicate
          xsi:type="predicates:LocationPredicate"
          pattern="\Q${git.clone.bonita-studio-sp.location|path}\E/community/bundles/plugins/.*"/>
    </workingSet>
    <workingSet
        name="tests-dependencies">
      <predicate
          xsi:type="predicates:LocationPredicate"
          pattern="\Q${git.clone.bonita-studio-sp.location|path}\E/community/tests-dependencies/.*"/>
    </workingSet>
    <workingSet
        name="community-test">
      <predicate
          xsi:type="predicates:LocationPredicate"
          pattern="\Q${git.clone.bonita-studio-sp.location|path}\E/community/tests/.*"/>
    </workingSet>
    <workingSet
        name="subscription-feature">
      <predicate
          xsi:type="predicates:LocationPredicate"
          pattern="\Q${git.clone.bonita-studio-sp.location|path}\E/subscription/bundles/features/.*"/>
    </workingSet>
    <workingSet
        name="subscription-plugin">
      <predicate
          xsi:type="predicates:LocationPredicate"
          pattern="\Q${git.clone.bonita-studio-sp.location|path}\E/subscription/bundles/plugins/.*"/>
    </workingSet>
    <workingSet
        name="subscription-test">
      <predicate
          xsi:type="predicates:LocationPredicate"
          pattern="\Q${git.clone.bonita-studio-sp.location|path}\E/subscription/tests/.*"/>
    </workingSet>
    <workingSet
        name="helper">
      <predicate
          xsi:type="predicates:LocationPredicate"
          pattern="\Q${git.clone.bonita-studio-sp.location|path}\E"/>
    </workingSet>
    <description>The dynamic working sets for ${scope.project.label}</description>
  </setupTask>
  <setupTask
      xsi:type="pde:TargetPlatformTask"
      name="${workspace.location|uri}/helper/community/platform/platform.target"/>
  <setupTask
      xsi:type="setup:CompoundTask"
      name="User Preferences">
    <setupTask
        xsi:type="setup:CompoundTask"
        name="org.eclipse.m2e.core">
      <setupTask
          xsi:type="setup:PreferenceTask"
          key="/instance/org.eclipse.m2e.core/eclipse.m2.globalSettingsFile"
          value="${mavenSettingsStudio|uri}"/>
    </setupTask>
  </setupTask>
  <stream name="dev"
      label="Dev">
    <setupTask
        xsi:type="setup:EclipseIniTask"
        option="-Doomph.redirection.bonita-studio-sp"
        value="=https://raw.githubusercontent.com/bonitasoft/bonita-studio/dev/setups/->${git.clone.bonita-studio-sp.location|uri}/community/setups/"
        vm="true">
      <description>
        Set an Oomph redirection system property to redirect the logical location of this setup to its physical location in the Git clone.
        Before enabling this task, replace '...' with the repository path of this setup's containing project.
      </description>
    </setupTask>
    <setupTask
        xsi:type="setup:VariableTask"
        name="eclipse.target.platform"
        defaultValue="2022-06"
        storageURI="scope://Workspace"/>
    <setupTask
        xsi:type="setup.targlets:TargletTask"
        disabled="true">
      <targlet
          name="${scope.project.label}VersionedDep_${scope.project.stream.name}">
        <requirement
            name="org.eclipse.gmf.feature.group"/>
        <requirement
            name="org.eclipse.gmf.tooling.runtime"/>
        <requirement
            name="org.eclipse.m2e.logback.feature.feature.group"/>
        <requirement
            name="de.jcup.asciidoctoreditor.feature.group"
            versionRange="2.5.1"/>
        <requirement
            name="de.jcup.yamleditor.feature.group"
            versionRange="1.9.0"/>
        <requirement
            name="net.sourceforge.plantuml.feature.feature.group"
            versionRange="1.1.26"/>
      </targlet>
    </setupTask>
  </stream>
  <stream name="master"
      label="Master">
    <setupTask
        xsi:type="setup:EclipseIniTask"
        option="-Doomph.redirection.bonita-studio-sp"
        value="=https://raw.githubusercontent.com/bonitasoft/bonita-studio/dev/setups/->${git.clone.bonita-studio-sp.location|uri}/community/setups/"
        vm="true">
      <description>
        Set an Oomph redirection system property to redirect the logical location of this setup to its physical location in the Git clone.
        Before enabling this task, replace '...' with the repository path of this setup's containing project.
      </description>
    </setupTask>
    <setupTask
        xsi:type="setup:VariableTask"
        name="eclipse.target.platform"
        defaultValue="2021-12"
        storageURI="scope://Workspace"/>
    <setupTask
        xsi:type="setup.targlets:TargletTask"
        disabled="true">
      <targlet
          name="${scope.project.label}VersionedDep_${scope.project.stream.name}">
        <requirement
            name="org.eclipse.gmf.sdk.feature.group"/>
        <requirement
            name="de.jcup.asciidoctoreditor.feature.group"
            versionRange="2.2.0"/>
        <requirement
            name="de.jcup.yamleditor.feature.group"
            versionRange="1.7.0"/>
        <requirement
            name="org.eclipse.team.svn.feature.group"/>
        <requirement
            name="org.eclipse.team.svn.m2e.feature.group"/>
        <requirement
            name="org.eclipse.team.svn.nl1.feature.group"/>
        <requirement
            name="org.eclipse.team.svn.revision.graph.feature.group"/>
        <requirement
            name="org.eclipse.team.svn.source.feature.group"/>
        <requirement
            name="org.polarion.eclipse.team.svn.connector.feature.group"/>
        <requirement
            name="org.polarion.eclipse.team.svn.connector.javahl18.feature.group"/>
        <requirement
            name="org.polarion.eclipse.team.svn.connector.svnkit18.feature.group"/>
        <requirement
            name="net.sourceforge.plantuml.feature.feature.group"
            versionRange="1.1.24"/>
      </targlet>
      <targlet
          name="Bonitasoft Mirror">
        <repositoryList
            name="4.16">
          <repository
              url="https://update-site.bonitasoft.com/p2/4.16"/>
        </repositoryList>
      </targlet>
    </setupTask>
  </stream>
  <logicalProjectContainer
      xsi:type="setup:ProjectCatalog"
      href="index:/org.eclipse.setup#//@projectCatalogs[name='com.github']"/>
  <description>
    Bonita Studio - Development environment.
    Ready for Eclipse IDE for RCP and RAP Developers - 2022-06.
  </description>
</setup:Project>
